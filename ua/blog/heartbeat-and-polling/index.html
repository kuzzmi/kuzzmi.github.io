<!DOCTYPE html><html lang="ua"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Heartbeat and Polling | –¢–µ—Ö–Ω—ñ—á–Ω—ñ —Å—Ç–∞—Ç—Ç—ñ | –Ü–≥–æ—Ä –ö—É–∑—å–º–µ–Ω–∫–æ</title><meta name="robots" content="index,follow"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="@kuzzmi"/><meta property="og:title" content="Heartbeat and Polling"/><meta property="og:description" content="Sometimes in your applications you want to track when the user&#x27;s PC went to sleep mode, so you can do some routine, such as reestablish the session, or connection. Or your user just opened your app and is doing nothing, but you need to keep the session opened. So what can we do?
"/><meta property="og:url" content="https://kuzzmi.com/ua/blog/heartbeat-and-polling/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2016-01-22T09:28:06Z"/><meta property="article:author" content="https://kuzzmi.com/about"/><meta property="article:tag" content="technology"/><meta property="article:tag" content="javascript"/><meta property="article:tag" content="tips"/><meta property="article:tag" content="web development"/><meta property="article:tag" content="patterns"/><meta property="og:image" content="https://kuzzmi.com/assets/articles/blog/heartbeat-and-polling/cover.png"/><meta property="og:image:alt" content="Heartbeat and Polling"/><meta property="og:image:type" content="image/png"/><meta property="og:image:width" content="1342"/><meta property="og:image:height" content="853"/><meta property="og:site_name" content="–Ü–≥–æ—Ä –ö—É–∑—å–º–µ–Ω–∫–æ"/><link rel="canonical" href="https://kuzzmi.com/ua/blog/heartbeat-and-polling/"/><meta name="next-head-count" content="24"/><link rel="dns-prefetch" href="https://www.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png"/><link rel="manifest" href="/static/site.webmanifest"/><link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon"/><meta name="apple-mobile-web-app-capable" content="yes"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/base16/railscasts.min.css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js"></script><meta name="author" content="Igor Kuzmenko"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/8d3077ef275150e2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8d3077ef275150e2.css" data-n-g=""/><link rel="preload" href="/_next/static/css/5efee9f793991289.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5efee9f793991289.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-fca90e9fb8aa5e83.js" defer=""></script><script src="/_next/static/chunks/pages/_app-84072d5e9d49e694.js" defer=""></script><script src="/_next/static/chunks/943-d7292ea680771043.js" defer=""></script><script src="/_next/static/chunks/pages/%5Blocale%5D/blog/%5Bslug%5D-ab157fa286a9d78a.js" defer=""></script><script src="/_next/static/mb0HY-pGsLK1p_NqLs-5o/_buildManifest.js" defer=""></script><script src="/_next/static/mb0HY-pGsLK1p_NqLs-5o/_ssgManifest.js" defer=""></script><script src="/_next/static/mb0HY-pGsLK1p_NqLs-5o/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&family=PT+Sans:ital,wght@0,400;0,700;1,400&display=swap">@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxjPg.woff) format('woff')}@font-face{font-family:'PT Sans';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizYRExUiTo99u79D0eEww.woff) format('woff')}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79P0Y.woff) format('woff')}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh4Oo.woff) format('woff')}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTN1OTk6OThhvAWV8.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTPlOTk6OThhvAWV8.woff) format('woff');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTOVOTk6OThhvAWV8.woff) format('woff');unicode-range:U+0370-03FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTNVOTk6OThhvAWV8.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTNFOTk6OThhvAWV8.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v13/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxTOlOTk6OThhvA.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'PT Sans';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizYRExUiTo99u79D0e0ysmIAjcQ-woy.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'PT Sans';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizYRExUiTo99u79D0e0w8mIAjcQ-woy.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'PT Sans';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizYRExUiTo99u79D0e0ycmIAjcQ-woy.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'PT Sans';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizYRExUiTo99u79D0e0x8mIAjcQ-w.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0-ExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0aExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0yExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0KExcOPIDU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0OOtLR8a8zILig.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0OqtLR8a8zILig.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0OCtLR8a8zILig.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0O6tLR8a8zI.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><main class="PageLayout_page_container__M8QGN "><menu class="PageLayout_menu_container__La6NU"><ul><li class="PageLayout_inactive__g2bTn"><a href="/ua/">–ì–æ–ª–æ–≤–Ω–∞</a></li><li><a href="/ua/blog/">–¢–µ—Ö–Ω—ñ—á–Ω—ñ —Å—Ç–∞—Ç—Ç—ñ</a></li><li class="PageLayout_inactive__g2bTn"><a href="/ua/thoughts/">–†–æ–∑–¥—É–º–∏</a></li><li class="PageLayout_inactive__g2bTn"><a href="/ua/about/">–ü—Ä–æ –º–µ–Ω–µ</a></li></ul></menu><section class="PageLayout_content_container__1IMZI"><header class="PageLayout_header_container__Y6dbq"><div><div class="PageLayout_menu_button__vWi4y"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24px" height="24px"><path fill="none" stroke="#000000" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M3 12L21 12M3 6L21 6M3 18L21 18"></path></svg></div><p class="PageLayout_name__xhUaP"></p></div><div class="PageLayout_lang_switcher___L3bH"><p class="PageLayout_version__2_iha">–≤–µ—Ä—Å—ñ—è<!-- -->:<!-- --></p><div class="PageLayout_langs__z_SxD"><a class="PageLayout_active__UxQoO" href="/ua/blog/heartbeat-and-polling/">üá∫üá¶</a><a class="" href="/en/blog/heartbeat-and-polling/">üá¨üáß</a></div></div></header><article class="PageLayout_content__6Pdc3"><div class="Post_container__jmeoa"><div class="Post_notAvailable__snvTZ">–¶–µ–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π —Ç—ñ–ª—å–∫–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é –º–æ–≤–æ—é.</div><h1>Heartbeat and Polling</h1><p class="Post_date__B7bMG">22.01.2016, 11:28:06</p><div><p>Sometimes in your applications you want to track when the user's PC went to sleep mode, so you can do some routine, such as reestablish the session, or connection. Or your user just opened your app and is doing nothing, but you need to keep the session opened, track connection issues and somehow react on that. So what can we do?</p>
<p>Answers are pretty simple, but sometimes it takes time to find it.</p>
<p>Heartbeat and polling are actually almost the same patterns, but I specifically separate them, because it's useful to use appropriate wording.</p>
<h2 id="polling">Polling</h2>
<p>This design pattern allows you to let server know that the browser is still opened, and to let your application know that there are no issues with the connection to the server. You can also use this to measure your connection, to track users' network performance and so on.</p>
<p>For example, you have an application, which has a server that ends inactive sessions <em>(this sounds obviously, but, yes, sometimes they may not do this‚Ä¶)</em>. Say that user wants to perform an action that requires him to be authenticated, but his session is invalidated already. In this case user will have errors, or another "please login" window, it depends on how you handle this kind of things.</p>
<p>But we're handling the problem instead of solving it, right? Although sometimes it's enough, but when it comes to the questions of UX, you can find that it's easier to fix it.</p>
<p>So we need to let server know that "hey, we're still here", and let user know that "hey, Houston, we have a problem" and let application solve the issue.</p>
<p>So the simpliest polling can be as easy as this code:</p>
<pre><code class="hljs">var pollInterval = <span class="hljs-number">60000</span>;
<span class="hljs-keyword">function</span> poll<span class="hljs-literal">()</span> {
    set<span class="hljs-constructor">Interval(<span class="hljs-params">function</span>()</span> {
        <span class="hljs-comment">// We need to make a request</span>
        <span class="hljs-comment">// I assume that you know how to make GET requests in JavaScript :)</span>
        make<span class="hljs-constructor">Request(&#x27;<span class="hljs-params">http</span>:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">example</span>.<span class="hljs-params">com</span><span class="hljs-operator">/</span><span class="hljs-params">api</span><span class="hljs-operator">/</span><span class="hljs-params">poll</span>&#x27;)</span>
            <span class="hljs-comment">// and properly handle the issues</span>
            .error(handlePollError);
    }, pollInterval);
}
</code></pre>
<p>That's it. Pretty straightforward, isn't it? The intersting part has to be done in <code>handlePollError</code> function. But it's very specific to each case. I usually suggest to display a message about connection issues, increase the interval timeout and to try to reconnect, until we're connected again.</p>
<h2 id="hearbeat">Hearbeat</h2>
<p>Heartbeat pattern is a similar to polling pattern and is used to understand whether the application is alive. In web applications it can be used to detect whether or not a user was in sleep mode and react accordingly. For example, you want to refresh the page if the user's machine was in the sleep mode.</p>
<p>To do that we may check when was the last time of calling a heartbeat function and if it exceeds the threshold, do what you need to do.</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> intervalTime = <span class="hljs-number">1000</span>;
<span class="hljs-keyword">var</span> <span class="hljs-built_in">now</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
 <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()).getTime();
};

<span class="hljs-keyword">var</span> lastInterval = <span class="hljs-built_in">now</span>();

<span class="hljs-keyword">var</span> intervalHeartbeat = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">var</span> <span class="hljs-built_in">now</span> = <span class="hljs-built_in">now</span>();
    <span class="hljs-keyword">var</span> diff = <span class="hljs-built_in">now</span> - lastInterval;
    <span class="hljs-keyword">var</span> <span class="hljs-built_in">offset</span> = diff - intervalTime;
    lastInterval = <span class="hljs-built_in">now</span>;

    <span class="hljs-comment">// here I check if the difference is more than</span>
    <span class="hljs-comment">// twenty minutes</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">offset</span> &gt; <span class="hljs-number">20</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>) {
        window.location.reload(<span class="hljs-literal">true</span>);
    }
};

setInterval(intervalHeartbeat, intervalTime);
</code></pre>
<p>That is it.</p>
<p>This may or may not be the best solutions, but they are used and they help you to fix a bunch of possible issues.</p>
<p>For curiosity's sake, how do you solve this problems? <a href="http://twitter.com/kuzzmi">Ping me on Twitter</a>.</p></div><div class="Post_footer__JGzaD">–°–ø–æ–¥–æ–±–∞–ª–∞—Å—å —Å—Ç–∞—Ç—Ç—è? –ù–∞ —á–∞–π –º–æ–∂–Ω–∞ –ª–∏—à–∏—Ç–∏ <a href="https://fundof.me/kuzzmi?tip" target="_blank" rel="noreferrer">–æ—Å—å —Ç—É—Ç</a> üòâ</div></div></article></section><div class="PageLayout_flag__XuZGa"><div class="PageLayout_blue__CUemv"></div><div class="PageLayout_yellow__R8WIm"></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"html":"\u003cp\u003eSometimes in your applications you want to track when the user's PC went to sleep mode, so you can do some routine, such as reestablish the session, or connection. Or your user just opened your app and is doing nothing, but you need to keep the session opened, track connection issues and somehow react on that. So what can we do?\u003c/p\u003e\n\u003cp\u003eAnswers are pretty simple, but sometimes it takes time to find it.\u003c/p\u003e\n\u003cp\u003eHeartbeat and polling are actually almost the same patterns, but I specifically separate them, because it's useful to use appropriate wording.\u003c/p\u003e\n\u003ch2 id=\"polling\"\u003ePolling\u003c/h2\u003e\n\u003cp\u003eThis design pattern allows you to let server know that the browser is still opened, and to let your application know that there are no issues with the connection to the server. You can also use this to measure your connection, to track users' network performance and so on.\u003c/p\u003e\n\u003cp\u003eFor example, you have an application, which has a server that ends inactive sessions \u003cem\u003e(this sounds obviously, but, yes, sometimes they may not do this‚Ä¶)\u003c/em\u003e. Say that user wants to perform an action that requires him to be authenticated, but his session is invalidated already. In this case user will have errors, or another \"please login\" window, it depends on how you handle this kind of things.\u003c/p\u003e\n\u003cp\u003eBut we're handling the problem instead of solving it, right? Although sometimes it's enough, but when it comes to the questions of UX, you can find that it's easier to fix it.\u003c/p\u003e\n\u003cp\u003eSo we need to let server know that \"hey, we're still here\", and let user know that \"hey, Houston, we have a problem\" and let application solve the issue.\u003c/p\u003e\n\u003cp\u003eSo the simpliest polling can be as easy as this code:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003evar pollInterval = \u003cspan class=\"hljs-number\"\u003e60000\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e poll\u003cspan class=\"hljs-literal\"\u003e()\u003c/span\u003e {\n    set\u003cspan class=\"hljs-constructor\"\u003eInterval(\u003cspan class=\"hljs-params\"\u003efunction\u003c/span\u003e()\u003c/span\u003e {\n        \u003cspan class=\"hljs-comment\"\u003e// We need to make a request\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e// I assume that you know how to make GET requests in JavaScript :)\u003c/span\u003e\n        make\u003cspan class=\"hljs-constructor\"\u003eRequest(\u0026#x27;\u003cspan class=\"hljs-params\"\u003ehttp\u003c/span\u003e:\u003cspan class=\"hljs-operator\"\u003e/\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e/\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003eexample\u003c/span\u003e.\u003cspan class=\"hljs-params\"\u003ecom\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e/\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003eapi\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e/\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003epoll\u003c/span\u003e\u0026#x27;)\u003c/span\u003e\n            \u003cspan class=\"hljs-comment\"\u003e// and properly handle the issues\u003c/span\u003e\n            .error(handlePollError);\n    }, pollInterval);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThat's it. Pretty straightforward, isn't it? The intersting part has to be done in \u003ccode\u003ehandlePollError\u003c/code\u003e function. But it's very specific to each case. I usually suggest to display a message about connection issues, increase the interval timeout and to try to reconnect, until we're connected again.\u003c/p\u003e\n\u003ch2 id=\"hearbeat\"\u003eHearbeat\u003c/h2\u003e\n\u003cp\u003eHeartbeat pattern is a similar to polling pattern and is used to understand whether the application is alive. In web applications it can be used to detect whether or not a user was in sleep mode and react accordingly. For example, you want to refresh the page if the user's machine was in the sleep mode.\u003c/p\u003e\n\u003cp\u003eTo do that we may check when was the last time of calling a heartbeat function and if it exceeds the threshold, do what you need to do.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e intervalTime = \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003enow\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eDate\u003c/span\u003e()).getTime();\n};\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e lastInterval = \u003cspan class=\"hljs-built_in\"\u003enow\u003c/span\u003e();\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e intervalHeartbeat = \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003enow\u003c/span\u003e = \u003cspan class=\"hljs-built_in\"\u003enow\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e diff = \u003cspan class=\"hljs-built_in\"\u003enow\u003c/span\u003e - lastInterval;\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eoffset\u003c/span\u003e = diff - intervalTime;\n    lastInterval = \u003cspan class=\"hljs-built_in\"\u003enow\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-comment\"\u003e// here I check if the difference is more than\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// twenty minutes\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-built_in\"\u003eoffset\u003c/span\u003e \u0026gt; \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e * \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e * \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e) {\n        window.location.reload(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e);\n    }\n};\n\nsetInterval(intervalHeartbeat, intervalTime);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThat is it.\u003c/p\u003e\n\u003cp\u003eThis may or may not be the best solutions, but they are used and they help you to fix a bunch of possible issues.\u003c/p\u003e\n\u003cp\u003eFor curiosity's sake, how do you solve this problems? \u003ca href=\"http://twitter.com/kuzzmi\"\u003ePing me on Twitter\u003c/a\u003e.\u003c/p\u003e","type":"blog","meta":{"slug":"heartbeat-and-polling","title":"Heartbeat and Polling","layout":"post","lang":"en","description":"Sometimes in your applications you want to track when the user's PC went to sleep mode, so you can do some routine, such as reestablish the session, or connection. Or your user just opened your app and is doing nothing, but you need to keep the session opened. So what can we do?\n","tags":["technology","javascript","tips","web development","patterns"],"date":"2016-01-22T09:28:06Z"}},"_nextI18Next":{"initialI18nStore":{"ua":{"common":{"common":{"name":"–Ü–≥–æ—Ä –ö—É–∑—å–º–µ–Ω–∫–æ","version":"–≤–µ—Ä—Å—ñ—è","articleFooter":"–°–ø–æ–¥–æ–±–∞–ª–∞—Å—å —Å—Ç–∞—Ç—Ç—è? –ù–∞ —á–∞–π –º–æ–∂–Ω–∞ –ª–∏—à–∏—Ç–∏ \u003ca href=\"https://fundof.me/kuzzmi?tip\" target=\"_blank\" rel=\"noreferrer\"\u003e–æ—Å—å —Ç—É—Ç\u003c/a\u003e üòâ","articleNotAvailable":"–¶–µ–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π —Ç—ñ–ª—å–∫–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é –º–æ–≤–æ—é."},"menu":{"home":"–ì–æ–ª–æ–≤–Ω–∞","blog":"–¢–µ—Ö–Ω—ñ—á–Ω—ñ —Å—Ç–∞—Ç—Ç—ñ","thoughts":"–†–æ–∑–¥—É–º–∏","podcast":"–ü–æ–¥–∫–∞—Å—Ç","projects":"–ü—Ä–æ—î–∫—Ç–∏","about":"–ü—Ä–æ –º–µ–Ω–µ"},"home":{"meta":{"description":"–î–æ–º–∞—à–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –Ü–≥–æ—Ä–∞ –ö—É–∑—å–º–µ–Ω–∫–∞"},"bio":"—Ä–æ–∑—Ä–æ–±–Ω–∏–∫ —Ç–∞ tech –ø—ñ–¥–ø—Ä–∏—î–º–µ—Ü—å","read":"–ß–∏—Ç–∞—Ç–∏","recents":"–û—Å—Ç–∞–Ω–Ω—ñ –¥–æ–ø–∏—Å–∏","description":{"part_1":"–¢—É—Ç —è –ø—É–±–ª—ñ–∫—É—é ","part_2":"—Å–≤–æ—ó —Ä–æ–∑–¥—É–º–∏","part_3":" —ñ ","part_4":" —Ç–µ—Ö–Ω—ñ—á–Ω—ñ —Å—Ç–∞—Ç—Ç—ñ","part_5":". –ó–∞–≤–∑—è—Ç–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á Linux —ñ vim. –°–ø—ñ–≤–∑–∞—Å–Ω–æ–≤–Ω–∏–∫ –≤ "}},"blog":{"description":"–ó–Ω–∞—Ö—ñ–¥–∫–∏ —ñ –≤—Å—ñ–ª—è–∫—ñ —Ü—ñ–∫–∞–≤–æ—Å—Ç—ñ, —è–∫–∏–º–∏ —è –∑–∞—Ö–æ—Ç—ñ–≤ –ø–æ–¥—ñ–ª–∏—Ç–∏—Å—è –∑—ñ —Å–≤—ñ—Ç–æ–º."},"thoughts":{"description":"–ú–æ—ó —Ä–æ–∑–¥—É–º–∏ –ø—Ä–æ –∂–∏—Ç—Ç—è —ñ —Ä–æ–±–æ—Ç—É."},"about":{"body":"–ü—Ä–∏–≤—ñ—Ç, –º–µ–Ω–µ –∑–≤—É—Ç—å –Ü–≥–æ—Ä –ö—É–∑—å–º–µ–Ω–∫–æ. –Ø –ª—é–±–ª—é —Å–≤–æ—é –¥—Ä—É–∂–∏–Ω—É, —Å–∏–Ω–∞, —Å–æ–±–∞–∫—É —Ç–∞ –∫–æ—Ç–∞. –ê —â–µ —è –ª—é–±–ª—é –≤–∏–≥–∞–¥—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ —à—Ç—É–∫–µ–Ω—Ü—ñ—ó —ñ –≤—Ç—ñ–ª—é–≤–∞—Ç–∏ —ó—Ö —É –∂–∏—Ç—Ç—è (—ñ–Ω–∫–æ–ª–∏ —Ü–µ –≤–¥–∞—î—Ç—å—Å—è, –∞–ª–µ —á–∞—Å—Ç—ñ—à–µ ‚Äî –Ω—ñ).\u003cbr /\u003e\u003cbr /\u003e–î–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–æ–≤–≥–æ –º–æ—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –±—É–ª–∞ —Å—Ö–æ–∂–∞ –Ω–∞ —Ä–µ–∑—é–º–µ —ñ–∑ –∫—É–ø–æ—é –∫–ª—ñ—à–µ, –º–µ–Ω—ñ —Ü–µ –Ω–∞–±—Ä–∏–¥–ª–æ —ñ —è –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏–≤ —ó—ó –Ω–∞ —â–æ—Å—å, —â–æ –±—ñ–ª—å—à–µ —Å—Ö–æ–∂–µ –Ω–∞ –º–µ–Ω–µ —ñ –º—ñ–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –∂–∏—Ç—Ç—è: –ø–æ—î–¥–Ω–∞–Ω–Ω—è –ª–µ–≥–∫–æ—Å—Ç—ñ, –µ—Å—Ç–µ—Ç–∏–∫–∏, –¥–µ—è–∫–æ—ó —Å–µ—Ä–π–æ–∑–Ω–æ—Å—Ç—ñ —ñ –≥—É–º–æ—Ä—É (\u003ci\u003e—ñ —Å–∫—Ä–æ–º–Ω–æ—Å—Ç—ñ\u003c/i\u003e).\u003cbr /\u003e\u003cbr /\u003e–£ –≤—ñ–ª—å–Ω–∏–π –≤—ñ–¥ —Ä–æ–±–æ—Ç–∏ —á–∞—Å —è –ø—Ä–æ–≤–æ–¥–∂—É –∑ —Ä–æ–¥–∏–Ω–æ—é, –∑–∞–π–º–∞—é—Å—è –ø–µ—Ç-–ø—Ä–æ—î–∫—Ç–∞–º–∏, –≥—Ä–∞—é —É –≤—ñ–¥–µ–æ —ñ–≥—Ä–∏ —ñ —â–µ –±–∞–≥–∞—Ç–æ —á–æ–≥–æ —Ä–æ–±–ª—é: –≤—ñ–¥ –≥—Ä–∏ –Ω–∞ —É–∫—É–ª—î–ª—î —ñ –º–∞–ª—é–≤–∞–Ω–Ω—è, –¥–æ –µ–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω—ñ–∫–∏ —ñ —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–≥–æ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∞–≤—Ç—ñ–≤–∫–æ—é.\u003cbr /\u003e\u003cbr /\u003e–Ø –±–µ–∑–ª—ñ—á —Ä–∞–∑—ñ–≤ –Ω–∞–º–∞–≥–∞–≤—Å—è –ø—ñ–¥–≤–∏—â–∏—Ç–∏ —Ä—ñ–≤–µ–Ω—å —Å–≤–æ—î—ó –æ–Ω–ª–∞–π–Ω-–ø—Ä–∏—Å—É—Ç–Ω–æ—Å—Ç—ñ, –ø—Ä–æ—Ç–µ —Ü–µ –Ω—ñ–∫–æ–ª–∏ –Ω–µ —Ç—Ä–∏–≤–∞—î –¥–æ–≤–≥–æ üôÉ\u003cbr /\u003e\u003cbr /\u003e–ú–æ—ó —Å–æ—Ü—ñ–∞–ª—å–Ω—ñ –º–µ—Ä–µ–∂—ñ —ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –æ—Å—å —Ç—É—Ç: \u003ca href=\"https://fundof.me/igor\"\u003efundof.me/igor\u003c/a\u003e"},"tags":{"philosophy":"—Ñ—ñ–ª–æ—Å–æ—Ñ—ñ—è","psychology":"–ø—Å–∏—Ö–æ–ª–æ–≥—ñ—è","story":"–º–æ—è —ñ—Å—Ç–æ—Ä—ñ—è","marketing":"–º–∞—Ä–∫–µ—Ç–∏–Ω–≥","startup":"—Å—Ç–∞—Ä—Ç–∞–ø–∏","bad advice":"—à–∫—ñ–¥–ª–∏–≤—ñ –ø–æ—Ä–∞–¥–∏","career":"–∫–∞—Ä'—î—Ä–∞","work":"—Ä–æ–±–æ—Ç–∞","burn out":"–≤–∏–≥–æ—Ä—è–Ω–Ω—è"}}},"en":{"common":{"common":{"name":"Igor Kuzmenko","version":"version","articleFooter":"If you enjoyed the reading, you can tip me \u003ca href=\"https://fundof.me/kuzzmi?tip\" target=\"_blank\" rel=\"noreferrer\"\u003ehere\u003c/a\u003e üòâ","articleNotAvailable":"This content is available only in Ukrainian."},"menu":{"home":"Home","blog":"Tech articles","thoughts":"Thoughts","podcast":"Podcast","projects":"Projects","about":"About me"},"home":{"meta":{"description":"Home page of Igor Kuzmenko"},"bio":"developer and tech entrepreneur","read":"Read","recents":"Recent publications","description":{"part_1":"Here I publish ","part_2":"my thoughts","part_3":" and ","part_4":" tech articles","part_5":". Avid Linux and vim user. Co-founder at "}},"blog":{"description":"Different findings in the tech world that I want to share with world."},"thoughts":{"description":"My thoughts about life and work in Ukrainian."},"about":{"body":"Hi üëã\u003cbr /\u003e\u003cbr /\u003eMy name is Igor Kuzmenko. I love my wife, son, dog and cat. And I love making things up and making them real (but more often this doesn't happen).\u003cbr /\u003e\u003cbr /\u003eFor a long time, my personal page seemed like an official paper with a bunch of clich√©s, so I got sick of it and turned it into something what feels more like me and my approach to life: a combination of lightness, aesthetics, some seriousness and humor (and modesty).\u003cbr /\u003e\u003cbr /\u003eI spend my spare time with my family, doing pet projects, playing video games and more: from playing the ukulele and drawing, to electrical engineering and sports car driving.\u003cbr /\u003e\u003cbr /\u003eI've tried countless times to increase my online presence, but it never lasts long üôÉ\u003cbr /\u003e\u003cbr /\u003eMy social networks and contacts are available here: \u003ca href=\"https://fundof.me/igor\"\u003efundof.me/igor\u003c/a\u003e"}}}},"initialLocale":"ua","userConfig":{"i18n":{"defaultLocale":"en","locales":["en","ua"]},"default":{"i18n":{"defaultLocale":"en","locales":["en","ua"]}}}}},"__N_SSG":true},"page":"/[locale]/blog/[slug]","query":{"locale":"ua","slug":"heartbeat-and-polling"},"buildId":"mb0HY-pGsLK1p_NqLs-5o","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>